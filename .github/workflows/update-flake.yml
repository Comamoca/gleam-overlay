name: Update Nix Flakes

on:
  schedule:
    - cron: '0 17 * * *'  # Run daily at 2 AM JST (17:00 UTC)
  workflow_dispatch:  # Allow manual trigger

jobs:
  nix-flake-update:
      permissions:
        contents: write
        id-token: write
        issues: write
        pull-requests: write
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v4
        - uses: DeterminateSystems/determinate-nix-action@v3
        - uses: DeterminateSystems/update-flake-lock@main
          with:
            pr-title: "Update Nix flake inputs"
            pr-labels: |
              dependencies
              automated

